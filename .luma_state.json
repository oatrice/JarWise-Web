{
  "version": "1.0",
  "project_key": "2",
  "phase": "coding",
  "active_issue": {
    "number": 67,
    "title": "[Feature] Hierarchical Accounts & Categories (Sub-Wallet, Sub-Jar)",
    "html_url": "https://github.com/oatrice/JarWise-Root/issues/67",
    "body": "# üéØ Objective\nImplement hierarchical structure for Accounts (Wallets) and Categories (Jars), enabling sub-items, flexible reorganization, and Promote/Demote functionality.\n\n## üìù Core Features\n\n### Dynamic Jars (Not Fixed 6)\n- [ ] **Custom Jars**: User can add/delete Jars beyond the default 6\n- [ ] **Default 6**: Pre-seed NEC, PLAY, EDU, FFA, GIVE, LTSS but allow modification\n- [ ] **% Target**: Optional - sum doesn't have to equal 100%\n\n### Nested Structure\n- [ ] **Parent-Child Relationships**: Jars ‚Üí Categories ‚Üí Sub-Categories\n- [ ] **Unlimited Depth**: (Consider limiting to 2-3 levels for UX)\n- [ ] **CRUD Operations**: Add, Edit, Delete at any level\n\n### Hierarchy Operations\n- [ ] **Promote**: Move Category up to become a Jar (with Goal support)\n- [ ] **Demote**: Move Jar down to become Category under another Jar\n- [ ] **Reorder**: Change sort order within same level\n- [ ] **Re-parent**: Move item under different parent\n\n## üîÑ Promote/Demote Use Case\n\n**Example: PLAY-EXTRA (Travel Expenses)**\n- Initially: Category under PLAY\n- Problem: Large travel expenses bloat PLAY report\n- Solution: **Promote to Jar** ‚Üí EXTRA becomes separate Jar with own Goal\n- Reversible: Can **Demote back** to Category if needed\n\n### Transaction Handling\n| Action | Transaction Impact |\n|--------|-------------------|\n| Promote (Cat ‚Üí Jar) | Update jar_id to new Jar ID |\n| Demote (Jar ‚Üí Cat) | Update jar_id back to Parent Jar |\n| Delete Jar/Cat | Require re-assignment before delete |\n\n## üìê Proposed Schema (Unified Allocations)\n\n```sql\nCREATE TABLE allocations (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    name VARCHAR(50) NOT NULL,\n    parent_id INTEGER,           -- NULL = top-level Jar\n    level INTEGER DEFAULT 0,     -- 0 = Jar, 1 = Category\n    target_percent INTEGER,      -- Only for level=0 (Jars)\n    icon VARCHAR(50),\n    color VARCHAR(20),\n    sort_order INTEGER DEFAULT 0,\n    is_system_default BOOLEAN DEFAULT 0,\n    is_active BOOLEAN DEFAULT 1,\n    FOREIGN KEY (parent_id) REFERENCES allocations(id)\n);\n```\n\n## üîó Related Issues\n- #57 (Custom Jars/Wallets)\n- #65 (Money Manager Migration - needs dynamic structure)\n- #68 (Report Filter - filter by Jar/Category)\n\n## üîó References\n- Feature ID: `HIER-01`",
    "project_item_id": "PVTI_lAHOATfKEM4BMuLizgklQYs",
    "project_id": "PVT_kwHOATfKEM4BMuLi",
    "repository": "oatrice/JarWise-Root"
  },
  "active_branch": "feat/67-hierarchical-accounts-categories",
  "started_at": "2026-01-31T16:16:00.735907",
  "checklist": {},
  "pr_url": null,
  "pr_number": null,
  "last_updated": "2026-01-31T16:16:02.872661"
}